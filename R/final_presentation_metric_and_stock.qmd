---
title: "The metric and stock DB with example of their format and use for WNAS, WGEEL and WGBAST"
author: "Cédric Briand, Jules Oliviéro, Jani Helminen"
fontsize: 20pt
filters:
  - quarto-kroki
  - speakernotes
title-slide-attributes:
  data-background-image: images/diaspara_background.png
  data-background-size: stretch
  data-background-opacity: "0.5"
logo: images/diaspara_participants_logo_withEUlogo.png
footer: ""
engine: knitr
format: 
  revealjs :
    self-contained: true
  pdf:
    speakernotes:
      displayNotes: true
      customStyle: |
        roundcorner=5pt,
        subtitlebelowline=true,
        subtitleaboveline=true,
        subtitlebackgroundcolor=yellow!70!white,
        backgroundcolor=blue!20!white,
        frametitle={Theorem},
        frametitlerule=true,
        frametitlebackgroundcolor=yellow!70!white,
theme: solarized
background-transition: fade
editor: visual
---

# Refresh from the previous presentations

![](images/clipboard-154407505.png)

# Refresh from the previous presentations

![](images/clipboard-4195111625.png)

# The DIADROMOUS DATABASE

```{dot}
//| label: fig-schema_diaspara
//| fig-cap: Structure of the schema in diaspara. Dashed arrow indicate inheritance, pink or red colors indicate work in progress, blue color refers to the stock database, green color to the metric database.
digraph schema {
rankdir=TB;
size="8,5"
node [style=filled, fillcolor=gray, shape = record];
ref [fillcolor="gray"
label=<<table border="0" cellborder="1" cellspacing="0" cellpadding="4">
<tr> <td> <b>ref</b> </td> </tr>
<tr> <td align="left">
"ref"."Deprecated"  <br align="left"/>
"ref"."EDMO" <br align="left"/>
"ref"."MSTAT" <br align="left"/>
"ref"."PRGOV" <br align="left"/>
"ref"."PURPM" <br align="left"/>
"ref"."StationDictionary" <br align="left"/>
"ref"."Station_DTYPE" <br align="left"/>
"ref"."WLTYP" <br align="left"/>
"ref".riversegments <br align="left"/>
"ref".tr_age_age <br align="left"/>
"ref".tr_area_are <br align="left"/>
"ref".tr_category_cat <br align="left"/>
"ref".tr_country_cou <br align="left"/>
"ref".tr_dataaccess_dta <br align="left"/>
"ref".tr_databasis_dtb <br align="left"/>
"ref".tr_datasource_dts <br align="left"/>
"ref".tr_destination_des <br align="left"/>
"ref".tr_estimationmethod_esm <br align="left"/>
"ref".tr_fishingarea_fia <br align="left"/>
"ref".tr_fishway_fiw <br align="left"/>
<font color="pink">
"ref".tr_gear_gea <br align="left"/>
</font>
"ref".tr_habitat_hab <br align="left"/>
"ref".tr_habitatlevel_lev <br align="left"/>
"ref".tr_habitattype_hty <br align="left"/>
"ref".tr_icworkinggroup_wkg <br align="left"/>
"ref".tr_lifestage_lfs <br align="left"/>
"ref".tr_maturity_mat <br align="left"/>
"ref".tr_metric_mtr <br align="left"/>
"ref".tr_missvalueqal_mis <br align="left"/>
"ref".tr_monitoring_mon <br align="left"/>
"ref".tr_nimble_nim <br align="left"/>
<font color="pink">
"ref".tr_objecttype_oty <br align="left"/>
</font>
"ref".tr_outcome_oco <br align="left"/>
"ref".tr_quality_qal <br align="left"/>
"ref".tr_rivernames_riv <br align="left"/>
"ref".tr_sex_sex <br align="left"/>
"ref".tr_species_spe <br align="left"/>
"ref".tr_timeperiod_tip <br align="left"/>
<font color="lightgreen">
"ref".tr_trait_tra <br align="left"/>
"ref".tr_traitmethod_trm <br align="left"/>
"ref".tr_traitnumeric_trn <br align="left"/>
"ref".tr_traitqualitative_trq <br align="left"/>
"ref".tr_traitvaluequal_trv <br align="left"/>
"ref".tr_units_uni <br align="left"/>
"ref".tr_version_ver
</font>
... <br align="left"/> </td> </tr> 
</table>> 
shape = cylinder]; 

dat [fillcolor="gray"
label=<<table border="0" cellborder="1" cellspacing="0" cellpadding="4">
<tr> <td> <b>dat</b> </td> </tr>
<tr> <td align="left">
<font color="lightblue">
dat.t_stock_sto<br align="left"/>
dat.t_metadata_met<br align="left"/>
</font>
dat.t_series_ser <br align="left"/>
dat.t_serannual_san <br align="left"/>
dat.t_group_gr <br align="left"/>
dat.t_grouptrait_grt <br align="left"/>
dat.t_fish_fi <br align="left"/>
... <br align="left"/> </td> </tr> 
</table>> 
shape = cylinder]; 

refeel [fillcolor="pink"
label=<<table border="0" cellborder="1" cellspacing="0" cellpadding="4">
<tr> <td> <b>refeel</b> </td> </tr>
<tr> <td align="left">
refeel.tg_trait_tra<br align="left"/>
refeel.tr_area_are<br align="left"/>
refeel.tr_traitmethod_trm<br align="left"/>
refeel.tr_traitnumeric_trn<br align="left"/>
refeel.tr_traitqualitative_trq<br align="left"/>
refeel.tr_traitvaluequal_trv<br align="left"/>
refeel.tr_version_ver
<br align="left"/>
</td> </tr> 
</table>> 
shape = cylinder];

dateel [fillcolor="pink"
label=<<table border="0" cellborder="1" cellspacing="0" cellpadding="4">
<tr> <td> <b>dateel</b> </td> </tr>
<tr> <td align="left">
<font color="blue">dateel.t_metadata_met</font> <br align="left"/>
<font color="blue">dateel.t_stock_sto</font> <br align="left"/>
dateel.t_series_ser <br align="left"/>
dateel.t_serannual_san <br align="left"/>
dateel.t_group_gr <br align="left"/>
dateel.t_grouptrait_grt <br align="left"/>
dateel.t_fish_fi <br align="left"/>
dateel.tj_seriesstation_ses <br align="left"/> </td> </tr>
</table>> 
shape = cylinder];

refbast [fillcolor="purple"
label=<<table border="0" cellborder="1" cellspacing="0" cellpadding="4">
<tr> <td> <b><font color="white">refbast</font></b> </td> </tr>
<tr> <td align="left">
<font color="white">
refbast.tr_area_are <br align="left"/> 
refbast.tr_estimationmethod_esm <br align="left"/> 
refbast.tr_rivernames_riv <br align="left"/> 
refbast.tr_version_ver <br align="left"/> 
</font>
<font color="pink">
refbast.tr_traitmethod_trm<br align="left"/>
refbast.tr_traitnumeric_trn<br align="left"/>
refbast.tr_traitqualitative_trq<br align="left"/>
refbast.tr_traitvaluequal_trv<br align="left"/>
</font>
</td> </tr> 
</table>> 
shape = cylinder];

datbast [fillcolor="purple"
label=<<table border="0" cellborder="1" cellspacing="0" cellpadding="4">
<tr> <td> <b><font color="white">datbast</font></b> </td> </tr>
<tr> <td align="left">
<font color="lightblue">
    datbast.t_stock_sto <br align="left"/>
    datbast.t_metadata_met <br align="left"/>
</font>
<font color="white">
    datbast.t_series_ser <br align="left"/>
    datbast.t_serannual_san <br align="left"/>
    datbast.t_group_gr <br align="left"/>
    datbast.t_grouptrait_grt <br align="left"/>
    datbast.t_fish_fi <br align="left"/>
</font> 
 </td> </tr>
</table>> 
shape = cylinder];

refnas [fillcolor="limegreen"
label=<<table border="0" cellborder="1" cellspacing="0" cellpadding="4">
<tr> <td> <b>refnas</b> </td> </tr>
<tr> <td align="left">
<font color="blue">
refnas.tg_additional_add <br align="left"/>
</font>
refnas.tr_area_are <br align="left"/>
refnas.tr_rivernames_riv <br align="left"/>
refnas.tr_version_ver <br align="left"/>

</td> </tr> 
</table>> 
shape = cylinder];

datnas [fillcolor="limegreen"
label=<<table border="0" cellborder="1" cellspacing="0" cellpadding="4">
<tr> <td> <b>datnas</b> </td> </tr>
<tr> <td align="left">
<font color="blue">
datnas.t_stock_sto <br align="left"/>
datnas.t_metadata_met <br align="left"/>
</font>
<font color="red">
datnas.t_archive_ar <br align="left"/>
</font>

</td> </tr>
</table>> 
shape = cylinder];  

reftrutta [fillcolor="tan1"
label=<<table border="0" cellborder="1" cellspacing="0" cellpadding="4">
<tr> <td> <b>reftrutta</b> </td> </tr>
<tr> <td align="left">
<br align="left"/>
<br align="left"/>
</td> </tr> 
</table>> 
shape = cylinder];

dattrutta [fillcolor="tan1"
label=<<table border="0" cellborder="1" cellspacing="0" cellpadding="4">
<tr> <td> <b>dattrutta</b> </td> </tr>
<tr> <td align="left">
<br align="left"/>
<br align="left"/>
</td> </tr> 
</table>> 
shape = cylinder];   

 # this in an archive


refeel -> ref [style="dashed"]
refbast -> ref [style="dashed"]
refnas -> ref [style="dashed"]
reftrutta -> ref [style="dashed"]
dateel -> dat [style="dashed"]
datnas -> dat [style="dashed"]
datbast -> dat [style="dashed"]
dattrutta -> dat [style="dashed"]
dateel -> refeel
datnas -> refnas
dattrutta -> reftrutta
datbast  -> refbast
dateel -> ref
datnas -> ref
dattrutta -> ref
datbast  -> ref


}
```

# The DIADROMOUS DATABASE

```{dot}
//| label: fig-schema_diaspara_simplified
//| fig-cap: Structure of the schema in diaspara. Dashed arrow indicate inheritance, pink or red colors indicate work in progress, blue color refers to the stock database, green color to the metric database.
digraph schema {
rankdir=TB;
size="8,5"
node [style=filled, fillcolor=gray, shape = record];
ref [fillcolor="gray"
label=<<table border="0" cellborder="1" cellspacing="0" cellpadding="4">
<tr> <td> <b>ref</b> </td> </tr>
<tr> <td align="left">
... <br align="left"/> </td> </tr> 
</table>> 
shape = cylinder]; 

dat [fillcolor="gray"
label=<<table border="0" cellborder="1" cellspacing="0" cellpadding="4">
<tr> <td> <b>dat</b> </td> </tr>
<tr> <td align="left">
<br align="left"/> </td> </tr> 
</table>> 
shape = cylinder]; 

refeel [fillcolor="pink"
label=<<table border="0" cellborder="1" cellspacing="0" cellpadding="4">
<tr> <td> <b>refeel</b> </td> </tr>
<tr> <td align="left">
<br align="left"/>
</td> </tr> 
</table>> 
shape = cylinder];

dateel [fillcolor="pink"
label=<<table border="0" cellborder="1" cellspacing="0" cellpadding="4">
<tr> <td> <b>dateel</b> </td> </tr>
<tr> <td align="left">
<br align="left"/>
</td> </tr> 
</table>> 
shape = cylinder];

refbast [fillcolor="purple"
label=<<table border="0" cellborder="1" cellspacing="0" cellpadding="4">
<tr> <td> <b>refbast</b> </td> </tr>
<tr> <td align="left">
<br align="left"/>
</td> </tr>  
</table>> 
shape = cylinder];

datbast [fillcolor="purple"
label=<<table border="0" cellborder="1" cellspacing="0" cellpadding="4">
<tr> <td> <b>datbast</b> </td> </tr>
<tr> <td align="left">
<br align="left"/>
</td> </tr> 
</table>> 
shape = cylinder];

refnas [fillcolor="limegreen"
label=<<table border="0" cellborder="1" cellspacing="0" cellpadding="4">
<tr> <td> <b>refeel</b> </td> </tr>
<tr> <td align="left">
<br align="left"/>
</td> </tr> 
</table>> 
shape = cylinder]; 

datnas [fillcolor="limegreen"
label=<<table border="0" cellborder="1" cellspacing="0" cellpadding="4">
<tr> <td> <b>datnas</b> </td> </tr>
<tr> <td align="left">
<br align="left"/>
</td> </tr> 
</table>> 
shape = cylinder]; 

reftrutta [fillcolor="tan1"
label=<<table border="0" cellborder="1" cellspacing="0" cellpadding="4">
<tr> <td> <b>reftrutta</b> </td> </tr>
<tr> <td align="left">
</td> </tr> 
</table>> 
shape = cylinder];

dattrutta [fillcolor="tan1"
label=<<table border="0" cellborder="1" cellspacing="0" cellpadding="4">
<tr> <td> <b>dattrutta</b> </td> </tr>
<tr> <td align="left">
</td> </tr> 
</table>> 
shape = cylinder];   

 # this in an archive


refeel -> ref [style="dashed"]
refbast -> ref [style="dashed"]
refnas -> ref [style="dashed"]
reftrutta -> ref [style="dashed"]
dateel -> dat [style="dashed"]
datnas -> dat [style="dashed"]
datbast -> dat [style="dashed"]
dattrutta -> dat [style="dashed"]
dateel -> refeel
datnas -> refnas
dattrutta -> reftrutta
datbast  -> refbast
dateel -> ref
datnas -> ref
dattrutta -> ref
datbast  -> ref


}
```

# The DIADROMOUS DATABASE

```{dot}
//| label: fig-schema_diaspara_ref
//| fig-cap: Referential only split in three parts.
digraph schema {
rankdir=TB;
size="8,5"
node [style=filled, fillcolor=gray, shape = record];

ref [fillcolor="gray"
label=<<table border="0" cellborder="1" cellspacing="0" cellpadding="4">
<tr> <td> <b>ref</b> </td> </tr>
<tr> <td align="left">
"ref".tr_lifestage_lfs <br align="left"/>
"ref".tr_maturity_mat <br align="left"/>
"ref".tr_metric_mtr <br align="left"/>
"ref".tr_missvalueqal_mis <br align="left"/>
"ref".tr_monitoring_mon <br align="left"/>
"ref".tr_nimble_nim <br align="left"/>
<font color="pink">
"ref".tr_objecttype_oty <br align="left"/>
</font>
"ref".tr_outcome_oco <br align="left"/>
"ref".tr_quality_qal <br align="left"/>
"ref".tr_rivernames_riv <br align="left"/>
"ref".tr_sex_sex <br align="left"/>
"ref".tr_species_spe <br align="left"/>
"ref".tr_timeperiod_tip <br align="left"/>
<font color="lightgreen">
"ref".tr_trait_tra <br align="left"/>
"ref".tr_traitmethod_trm <br align="left"/>
"ref".tr_traitnumeric_trn <br align="left"/>
"ref".tr_traitqualitative_trq <br align="left"/>
"ref".tr_traitvaluequal_trv <br align="left"/>
"ref".tr_units_uni <br align="left"/>
"ref".tr_version_ver
</font>
... <br align="left"/> </td> </tr> 
</table>> 
shape = cylinder]; 

refter[fillcolor="gray"
label=<<table border="0" cellborder="1" cellspacing="0" cellpadding="4">
<tr> <td> <b>ref (ICES tables)</b> </td> </tr>
<tr> <td align="left">
"ref"."Deprecated"  <br align="left"/>
"ref"."EDMO" <br align="left"/>
"ref"."MSTAT" <br align="left"/>
"ref"."PRGOV" <br align="left"/>
"ref"."PURPM" <br align="left"/>
"ref"."StationDictionary" <br align="left"/>
"ref"."Station_DTYPE" <br align="left"/>
"ref"."WLTYP" <br align="left"/>
... <br align="left"/> </td> </tr> 
</table>> 
shape = cylinder]; 

refbis [fillcolor="gray"
label=<<table border="0" cellborder="1" cellspacing="0" cellpadding="4">
<tr> <td> <b>ref</b> </td> </tr>
<tr> <td align="left">
"ref".riversegments <br align="left"/>
"ref".tr_age_age <br align="left"/>
"ref".tr_area_are <br align="left"/>
"ref".tr_category_cat <br align="left"/>
"ref".tr_country_cou <br align="left"/>
"ref".tr_dataaccess_dta <br align="left"/>
"ref".tr_databasis_dtb <br align="left"/>
"ref".tr_datasource_dts <br align="left"/>
"ref".tr_destination_des <br align="left"/>
"ref".tr_estimationmethod_esm <br align="left"/>
"ref".tr_fishingarea_fia <br align="left"/>
"ref".tr_fishway_fiw <br align="left"/>
<font color="pink">
"ref".tr_gear_gea <br align="left"/>
</font>
"ref".tr_habitat_hab <br align="left"/>
"ref".tr_habitatlevel_lev <br align="left"/>
"ref".tr_habitattype_hty <br align="left"/>
"ref".tr_icworkinggroup_wkg <br align="left"/>
"ref".tr_lifestage_lfs <br align="left"/>
... <br align="left"/> </td> </tr> 
</table>> 
shape = cylinder]; 
}
```

<a href="https://diaspara.bordeaux-aquitaine.inrae.fr/deliverables/wp3/p7/stockdb.html#species-tr_species_spe" species>Species referential</a>

# The DIADROMOUS DATABASE

```{dot}
//| label: fig-schema_diaspara_withoutref
//| fig-cap: Structure of the schema in diaspara. Dashed arrow indicate inheritance, pink or red colors indicate work in progress, blue color refers to the stock database, green color to the metric database.
digraph schema {
rankdir=TB;
size="8,5"
node [style=filled, fillcolor=gray, shape = record];
ref [fillcolor="gray"
label=<<table border="0" cellborder="1" cellspacing="0" cellpadding="4">
<tr> <td> <b>ref</b> </td> </tr>
... <br align="left"/> </td> </tr> 
</table>> 
shape = cylinder]; 

dat [fillcolor="gray"
label=<<table border="0" cellborder="1" cellspacing="0" cellpadding="4">
<tr> <td> <b>dat</b> </td> </tr>
<tr> <td align="left">
<font color="lightblue">
dat.t_stock_sto<br align="left"/>
dat.t_metadata_met<br align="left"/>
</font>
dat.t_series_ser <br align="left"/>
dat.t_serannual_san <br align="left"/>
dat.t_group_gr <br align="left"/>
dat.t_grouptrait_grt <br align="left"/>
dat.t_fish_fi <br align="left"/>
... <br align="left"/> </td> </tr> 
</table>> 
shape = cylinder]; 

refeel [fillcolor="pink"
label=<<table border="0" cellborder="1" cellspacing="0" cellpadding="4">
<tr> <td> <b>refeel</b> </td> </tr>
<tr> <td align="left">
refeel.tg_trait_tra<br align="left"/>
refeel.tr_area_are<br align="left"/>
refeel.tr_traitmethod_trm<br align="left"/>
refeel.tr_traitnumeric_trn<br align="left"/>
refeel.tr_traitqualitative_trq<br align="left"/>
refeel.tr_traitvaluequal_trv<br align="left"/>
refeel.tr_version_ver
<br align="left"/>
</td> </tr> 
</table>> 
shape = cylinder];

dateel [fillcolor="pink"
label=<<table border="0" cellborder="1" cellspacing="0" cellpadding="4">
<tr> <td> <b>dateel</b> </td> </tr>
<tr> <td align="left">
<font color="blue">dateel.t_metadata_met</font> <br align="left"/>
<font color="blue">dateel.t_stock_sto</font> <br align="left"/>
dateel.t_series_ser <br align="left"/>
dateel.t_serannual_san <br align="left"/>
dateel.t_group_gr <br align="left"/>
dateel.t_grouptrait_grt <br align="left"/>
dateel.t_fish_fi <br align="left"/>
dateel.tj_seriesstation_ses <br align="left"/> </td> </tr>
</table>> 
shape = cylinder];

refbast [fillcolor="purple"
label=<<table border="0" cellborder="1" cellspacing="0" cellpadding="4">
<tr> <td> <b><font color="white">refbast</font></b> </td> </tr>
<tr> <td align="left">
<font color="white">
refbast.tr_area_are <br align="left"/> 
refbast.tr_estimationmethod_esm <br align="left"/> 
refbast.tr_rivernames_riv <br align="left"/> 
refbast.tr_version_ver <br align="left"/> 
</font>
<font color="pink">
refbast.tr_traitmethod_trm<br align="left"/>
refbast.tr_traitnumeric_trn<br align="left"/>
refbast.tr_traitqualitative_trq<br align="left"/>
refbast.tr_traitvaluequal_trv<br align="left"/>
</font>
</td> </tr> 
</table>> 
shape = cylinder];

datbast [fillcolor="purple"
label=<<table border="0" cellborder="1" cellspacing="0" cellpadding="4">
<tr> <td> <b><font color="white">datbast</font></b> </td> </tr>
<tr> <td align="left">
<font color="lightblue">
    datbast.t_stock_sto <br align="left"/>
    datbast.t_metadata_met <br align="left"/>
</font>
<font color="white">
    datbast.t_series_ser <br align="left"/>
    datbast.t_serannual_san <br align="left"/>
    datbast.t_group_gr <br align="left"/>
    datbast.t_grouptrait_grt <br align="left"/>
    datbast.t_fish_fi <br align="left"/>
</font> 
 </td> </tr>
</table>> 
shape = cylinder];

refnas [fillcolor="limegreen"
label=<<table border="0" cellborder="1" cellspacing="0" cellpadding="4">
<tr> <td> <b>refnas</b> </td> </tr>
<tr> <td align="left">
<font color="blue">
refnas.tg_additional_add <br align="left"/>
</font>
refnas.tr_area_are <br align="left"/>
refnas.tr_rivernames_riv <br align="left"/>
refnas.tr_version_ver <br align="left"/>

</td> </tr> 
</table>> 
shape = cylinder];

datnas [fillcolor="limegreen"
label=<<table border="0" cellborder="1" cellspacing="0" cellpadding="4">
<tr> <td> <b>datnas</b> </td> </tr>
<tr> <td align="left">
<font color="blue">
datnas.t_stock_sto <br align="left"/>
datnas.t_metadata_met <br align="left"/>
</font>
<font color="red">
datnas.t_archive_ar <br align="left"/>
</font>

</td> </tr>
</table>> 
shape = cylinder];  

reftrutta [fillcolor="tan1"
label=<<table border="0" cellborder="1" cellspacing="0" cellpadding="4">
<tr> <td> <b>reftrutta</b> </td> </tr>
<tr> <td align="left">
<br align="left"/>
<br align="left"/>
</td> </tr> 
</table>> 
shape = cylinder];

dattrutta [fillcolor="tan1"
label=<<table border="0" cellborder="1" cellspacing="0" cellpadding="4">
<tr> <td> <b>dattrutta</b> </td> </tr>
<tr> <td align="left">
<br align="left"/>
<br align="left"/>
</td> </tr> 
</table>> 
shape = cylinder];   

 # this in an archive


refeel -> ref [style="dashed"]
refbast -> ref [style="dashed"]
refnas -> ref [style="dashed"]
reftrutta -> ref [style="dashed"]
dateel -> dat [style="dashed"]
datnas -> dat [style="dashed"]
datbast -> dat [style="dashed"]
dattrutta -> dat [style="dashed"]
dateel -> refeel
datnas -> refnas
dattrutta -> reftrutta
datbast  -> refbast
dateel -> ref
datnas -> ref
dattrutta -> ref
datbast  -> ref


}
```

# STOCK DB

![](images/copilot_stock_model.png)

# STOCK db (WGNAS)

<!-- JANI : Can you explain the changes you have done to the WGNAS DB,
and why it should not alter the flow of data -->



# STOCK db (WGNAS)

<!-- JANI : OK, but what consequence does it have on the shiny application (salmoglob) -->

# STOCK db (WGEEL)

<!-- JANI : Very weel for WGNAS, how does that work for WGEEL, which annexes have you kept -->

# STOCK db (WBAST)

<!-- JANI : From what we have seen there are three DB in WGBAST, how do you adapt to this ? -->
![](images/clipboard-3336618413.png)

# STOCK db (What have we done so far)


-   Generalisation of metadata to define the variables used

-   Additional column for WGNAS (messy but adapted and will do nice for WGBAST) also type in metadata

-   Calendar data \< year in wgbast

-   Data source in WGBAST

-   Habitat structure (Illustrate in detail the use of recursive queries to get habitat)



## Example: River Daugava

![](images/clipboard-1464342884.png)

## Example: River Daugava & Gulf of Riga


> SELECT * FROM ref.get_parent_area(310, 'WGBAST');


![Parents from Gulf of Riga](images/clipboard-4250192328.png)


## Example: Gulf of Riga

> SELECT * FROM ref.get_parent_area(7025, 'WGBAST');

![Parents from Gulf of Riga](images/clipboard-3762430346.png)


# Stock DB (Future WORK)

## Stock DB (Future Work WGNAS)

##  Presentation of possibilities to go to lower level

=\> Jules explain, show that now we are based on area we can do it easily.

## METRIC db

::::: columns
::: {.column .incremental width="40%"}
![](images/clipboard-1207399477.png){fig-align="left" width="400"}
:::

::: {.column width="60%"}
![](images/clipboard-2784958256.png){width="450"}
:::
:::::

## METRIC db and examples of use

-   WGEEL base

    -   The WGBAST trout data is now adapted to this.

-   WP2: data tests done

-   Expand the WGNAS and WGBAST datasets to use of traps and e-fishing data

# All WGs now able to go deeper in their process

-   WGEEL: spatial model possible

-   WGBAST: data structured better. The tools will be available and can fit into what they are doing.

-   WGNAS: Data management up to date.

-   All: Potential to have much more, without having to put a lot of effort

## Keeping the data flow

-   The current db (WGEEL and WGBAST as examples)

    -   This is what is currently asked in datacalls

-   We don't want to disrupt the data flow, so our objective is to provide structures very close to the current DB (with queries and views)

    -   (show the current db and the final product)

-   These structures will be progressively replaced by data flows coming from the RDBES. the RDBES  will have upload, data checking, view and download tools to handle those data

    -   (maybe agregate it ?.... Talk to Henrik)

![](images/clipboard-55398605.png)

# Keeping the data flow

::::: columns
::: {.column .incremental width="50%"}
-   The roadmaps are in timeline (at least the latest)
-   Integration ICES if accepted.
    -   Otherwise we have a tool working in postgres as a backup
:::

::: {.column width="50%"}
**Use in TAF with different steps.**

1.  Data call or RDBES

2.  Workflow TAF

3.  data checks (shiny app)

4.  integration end of TAF

5.  run models

6.  Import outputs and calibrated variables

7.  store data (all samples) in Rdata TAF.
:::
:::::

# TODO WGNAS =\> lower level for WGNAS.

# Quality control (taken from previous dam presentation)

::::: Columns
::: {.column width="50%"}
-   Need of DB input and output in TAF
-   Data treatment
-   Tried to follow the existing WG formats as closely as possible, to not destroy current work!
:::

::: {.column width="50%"}
-   EXAMPLES
-   Show Hennis or NAS
-   What has been done in WGNAS
-   Shiny treatment of the output to detect changes
-   Pierre Yeves
:::
:::::

# EXAMPLES FROM CEDRIC HERE

-   WGBAST 2 databases are used
-   WGNAS work briefly